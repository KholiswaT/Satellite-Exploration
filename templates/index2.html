<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Leaflet Step-1</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.0-rc.3/dist/leaflet.css" />
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.3/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.5.0/d3.min.js"></script>

  <!-- Leaflet JavaScript -->
  <script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js"
  integrity="sha512-tAGcCfR4Sc5ZP5ZoVz0quoZDYX5aCtEm/eu1KhSLj2c9eFrylXZknQYmxUssFaVJKvvc0dJQixhGjG2yXWiV9Q=="
  crossorigin=""></script>  
  <script type="text/javascript" src="https://unpkg.com/leaflet.markercluster@1.0.3/dist/leaflet.markercluster.js"></script>
  <!-- Our JavaScript -->
  <script type="text/javascript" src="{{url_for('static', filename='config.js') }}"></script>
<!--
  <script type="text/javascript" src="{{url_for('static', filename='/plot.js') }}"></script>
-->
  <script>

    var responsedata = '{{ responsedata | tojson | safe }}';


    var newYorkCoords = [-115.814, 32.7488333];
var mapZoomLevel = 8;
var geojson;
//d3.json(geoData, creaetMarkers);
var satelite = L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}", {
attribution: "© <a href='https://www.mapbox.com/about/maps/'>Mapbox</a> © <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> <strong><a href='https://www.mapbox.com/map-feedback/' target='_blank'>Improve this map</a></strong>",
tileSize: 512,
maxZoom: 18,
zoomOffset: -1,
id: "mapbox/streets-v11",
accessToken: API_KEY
});
var lightmap = L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}", {
  attribution: "© <a href=\“https://www.openstreetmap.org/\“>OpenStreetMap</a> contributors, <a href=\“https://creativecommons.org/licenses/by-sa/2.0/\“>CC-BY-SA</a>, Imagery © <a href=\“https://www.mapbox.com/\“>Mapbox</a>",
  maxZoom: 18,
  id: "dark-v10",
  accessToken: API_KEY
});
//.addTo(myMap);
// Streetmap Layer

//satelite.addTo(myMap);

cl="green"
  opac=0.9
  var stateMarkers = [];
  var geocode = JSON.parse(responsedata);
  for (var i=1; i<geocode['respdata'].length; i++) {
    console.log("This is within the for condition");
    console.log(geocode['respdata'][i]);
    console.log(geocode['respdata'][i]['longitude']);
   
    stateMarkers.push(
      L.circle([geocode['respdata'][i]['latitude'],geocode['respdata'][i]['longitude']], {
        fillOpacity: opac,
        color: cl,
        fillColor: "black",
        radius: 4*10000
      }).bindPopup("<h3> latitude:" + geocode['respdata'][i]['latitude'] + "</h3> <br> <h3>longitude: " + geocode['respdata'][i]['longitude'] + "</h3><br>"));

      L.circle([geocode['respdata'][i]['latitude'],geocode['respdata'][i]['longitude']], {
        fillOpacity: opac,
        color: "black",
        fillColor: cl,
        // Setting our circle's radius equal to the output of our markerSize function
        // This will make our marker's size proportionate to its population
        radius: 4*10000
      }).bindPopup("<h3> latitude:" + geocode['respdata'][i]['latitude'] + "</h3> <br> <h3>longitude: " + geocode['respdata'][i]['longitude'] + "</h3><br>")
                             
                  
}

//console.log(stateMarkers);
var states = L.layerGroup(stateMarkers);



console.log(API_KEY);


// Create a baseMaps object

var baseMaps = {
  "Satellite Map": satelite,
  "GrayScale Map": lightmap

};

// Create an overlay object
var overlayMaps = {
  "Earth Quake Map": states
};



  </script>
   
</head>
<body>
    <div id="mapid"></div>

    <script>
      var myMap = L.map("mapid", {
  center: [0.01432856, 45.97355747],
  zoom: mapZoomLevel
  });
  satelite.addTo(myMap);
  states.addTo(myMap);
  L.control.layers(baseMaps, overlayMaps, {
  collapsed: false
  }).addTo(myMap);   
  </script>
</body>
</html>



